{% from "govuk/components/button/macro.njk" import govukButton %}
{% from "govuk/components/back-link/macro.njk" import govukBackLink %}
{% from "govuk/components/radios/macro.njk" import govukRadios %}
{% from "govuk/components/inset-text/macro.njk" import govukInsetText %}
{% from "govuk/components/textarea/macro.njk" import govukTextarea %}
{% from "../../../partials/errorSummary.njk" import errorSummary %}
{% extends "../../../partials/layout.njk" %}

{% set pageTitle = "How have you been feeling since we last spoke?" %}
{% set mainClasses = "app-container govuk-body" %}

{% block beforeContent %}
  {{
    govukBackLink({
      text: "Back",
      href: "/" + submissionId + "/check-your-answers" if cya else "/" + submissionId + "/verify"
    })
  }}
{% endblock %}

{% block content %}
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
      {{ errorSummary(validationErrors) }}
      {% set veryWellHtml %}
        {{ govukTextarea({
          name: "mentalHealthVeryWell",
          id: "mentalHealthVeryWell",
          label: { text: "Tell us why you are very well (optional)" },
          value: formData["mentalHealthVeryWell"],
          errorMessage: validationErrors | findError("mentalHealthVeryWell")
        }) }}
      {% endset -%}

      {% set wellHtml %}
        {{ govukTextarea({
          name: "mentalHealthWell",
          id: "mentalHealthWell",
          label: { text: "Tell us why you are well (optional)" },
          value: formData["mentalHealthWell"],
          errorMessage: validationErrors | findError("mentalHealthWell")
        }) }}
      {% endset -%}

      {% set okHtml %}
        {{ govukTextarea({
          name: "mentalHealthOk",
          id: "mentalHealthOk",
          label: { text: "Tell us why you are OK (optional)" },
          value: formData["mentalHealthOk"],
          errorMessage: validationErrors | findError("mentalHealthOk")
        }) }}
      {% endset -%}

      {% set notGreatHtml %}
        {{ govukTextarea({
          name: "mentalHealthNotGreat",
          id: "mentalHealthNotGreat",
          label: { text: "Tell us why you are not great (optional)" },
          value: formData["mentalHealthNotGreat"],
          errorMessage: validationErrors | findError("mentalHealthNotGreat")
        }) }}
      {% endset -%}

      {% set strugglingHtml %}
        {{ govukTextarea({
          name: "mentalHealthStruggling",
          id: "mentalHealthStruggling",
          label: { text: "Tell us why you are struggling (optional)" },
          value: formData["mentalHealthStruggling"],
          errorMessage: validationErrors | findError("mentalHealthStruggling")
        }) }}
      {% endset -%}

      <form method="POST">
        <input type="hidden" name="_csrf" value="{{ csrfToken }}" />
        {{
          govukRadios({
          name: "mentalHealth",
          errorMessage: validationErrors | findError("mentalHealth"),
          value: formData["mentalHealth"],
          hint: {
            text: "Think about things like if you have noticed a change in your mood and what may have caused this. "
          },
          fieldset: {
            legend: {
              text: "How have you been feeling since we last spoke?",
              isPageHeading: true,
              classes: "govuk-fieldset__legend--l"
            }
          },
          items: [
              {
                value: "VERY_WELL",
                text: "Very well",
                conditional: {
                  html: veryWellHtml
                }
              },
              {
                value: "WELL",
                text: "Well",
                conditional: {
                  html: wellHtml
                }
              },
              {
                value: "OK",
                text: "OK",
                conditional: {
                  html: okHtml
                }
              },
              {
                value: "NOT_GREAT",
                text: "Not great",
                conditional: {
                  html: notGreatHtml
                }
              },
              {
                value: "STRUGGLING",
                text: "Struggling",
                conditional: {
                  html: strugglingHtml
                }
              }
            ]
          })
        }}
        {{
          govukInsetText({
            html: 'If you need to speak to someone urgently about how you are feeling, check the <a href="https://www.nhs.uk/mental-health/feelings-symptoms-behaviours/behaviours/help-for-suicidal-thoughts/" class="govuk-link" target="_blank">NHS website for help (opens in new tab)</a>.'
          })
        }}
        {{
          govukButton({
            text: "Continue"
          })
        }}
      </form>
    </div>
  </div>
{% endblock %}